---
description: Docs intro
layout: ../../../layouts/MainLayout.astro
---

# 函数初步

## 概述

### 什么是函数

在程序中，函数就具备某一功能的工具，是组织好的，可重复使用的，用来实现单一，或相关联功能的代码段。

函数能提高程序的模块性，和代码的利用率。

在之前，我们已经接触到了Python提供了许多内建函数，比如`print()`。但你也可以自己创建函数，即**用户自定义函数**。

不使用函数会造成以下问题：

1. 程序冗长（会写很多重复的东西）
2. 程序的扩展性差（要想添加新功能无从下手）
3. 程序的可读性差（代码难以被读懂）

### 函数的三要素

+ 功能(function)：一个函数的功能，比如进行某运算，或打印指定内容。

+ 参数(params)：由主程序传递给函数的变量，如两数加法，需要给函数传递两个数值类型的变量，进行计算。

+ 返回值(return)：即函数的处理结果。

下文会详细说明

函数的使用分为：**函数的定义**和**函数的调用**两个阶段

## 函数的定义和调用

+ 函数定义的格式如下：

```python
def 函数名(参数列表):
    函数代码体
其他程序代码
```

例如：

```python
'''
@function: 两数之和
@parameters: a, b
@return: a + b
'''
def add(a, b):
    return a + b
```

你也可以在定义时对函数进行类型标注，语法如下：

```python
def 函数名(参数1: 参数1类型, 参数2: 参数2类型, ...) -> 返回值类型:
    函数代码体
其他程序代码
```

很少用到，会在**番外——类型标注**中详细讲解。

在函数定义阶段，解释器只会检查函数代码体的和函数定义的语法，而不会执行代码体的内容。

Python中，不支持定义一个空函数。不过，在拿不定主意要写什么时，可以使用`pass`语句进行标志，例如：

```python
# EK算法，想先放着以后写，可以用pass
def Edmond_Karp()
	pass
```

`pass`不会被程序执行

+ 函数调用的格式如下：

```python
函数名(给定参数值)
```

其中，给定参数值要与参数列表中的相对应，例如：

```python
# 函数定义，参数列表为空
def greet():
    print("Hello")
# 函数调用，无需传入
greet()						# 打印 Hello

# 函数定义，接收一个参数
def greet(name):
    print("Hello, " + name)
# 函数调用，传入name="DrSHW"
greet("DrSHW")				# 打印 Hello, DrSHW

# 函数定义，接收两个参数
def add(a, b)
	return a + b			# 返回值，即计算结果
res = add(1, 2)		
print(res)					# 3
```

在函数定义时，系统会开辟一块地址空间，我们试着打印一个函数：

```python
def fun():
    pass
print(fun)			# <function fun at 0x000001B1440DF160>
```

`0x000001B1440DF160`即为该函数的内存地址，函数调用的本质即为调用此段内存空间。

函数本身也是一类变量，这意味着你可以将函数赋值给一个变量：

```python
def f(x, y):
    return x + y
g = f				# 本质上是把f的内存地址赋值给g
print(g(1, 2))		# 3，调用的是一个内存，所以执行一样的函数
```

所以，其实函数名只是对地址的一个引用而已，真正发挥作用的还是那块内存地址。

实际上这种操作没有任何实际意义，只是为了我们更好地对函数的本质进行理解。

函数也可以作为参数进行传递，具体会在下一节**函数高级**详细讲解。

## 函数的参数

### 形参与实参

参数可以分为两大类，即**形式参数**和**实际参数**：

+ 形式参数（形参）指的是在定义函数阶段括号内指定变量名，如上例`greet()`函数中的参数`name`
+ 实际参数（实参）指的是主程序中定义的，向函数传递的参数，如上例主程序向`greet()`函数传递的字符串`"DrSHW"`

实参传入函数后，在函数中会以形参的身份参与函数体程序：

若传入的实参是不可变类型，即使函数对其进行了改变，主程序中的该实参也不会改变(甚至在一定情况下会报错)，例如：

```python
# 试图交换两个数
def swap(a, b):
	a, b = b, a
a = 1
b = 2
swap(a, b)
print(a, b)			# 1, 2 说明a、b的值未更改
```

若传入的实参是不可变类型，若函数对其进行了改变，该改变则会保留，例如：

```python
# 自定义的append()函数
def myAppend(L, elem):
    L.append(elem)
li = [1, 2, 3]
myAppend(li, 4)
print(li)			# [1, 2, 3, 4] 列表值改变了
```

函数中可以获取到定义过的变量，若该变量为可变类型，可以保留对其的修改；若是不可变类型，则修改将被丢弃，例如：

```python
a = 10
L = [1, 3, 5]
def test():
    a = 5
    del L[1]
test()
print(a, L)		# 10 [1, 5]
```

若需要将对不可变类型的改变保留，可以使用`global`关键字进行声明，例如：

```python
a = 10
def test():
    global a
    a = 5
test()
print(a)		# 10
```

### 参数的传递方式

对于有参函数，有四种参数的传递方式：

1. 位置形参和位置实参

   用的最多，以上举过的有参函数的例子均为位置形参。

   定义的位置形参必须被实参传值，多一个不行，少一个也不行，且位置一一对应，例如：

   ```python
   def addThreeNums(a, b, c):		# 位置形参a, b, c
       return  a + b + c
   
   res = addThreeNums(1, 2, 3)		# 传入的位置实参必须与位置实参数目一致，即3个，其中1对应a，2对应b，3对应c
   print(res)						# 6
   '''
   错误示范(参数个数有误)：
   res = addThreeNums(1, 2)		# 传入2个参数，实际要3个
   res = addThreeNums(1, 2, 3, 4)	# 传入4个参数，实际要3个
   '''
   ```

2. 关键字实参

   即在调用函数阶段，按照`key=value`的形式指名道姓地为形参传值。

   注意：

   1. 可以完全打乱顺序，但仍然需要指名道姓为指定的形参传值；
   2. 可以混合使用位置实参与关键字实参, 但是必须注意：

      + 所有的位置实参必须放到关键字实参**前面**；
      + 不能对一个形参重复赋值。

   例如：

   ```python
   def addThreeNums(a, b, c):				# 位置形参a, b, c
       return  a + b + c
    # 全部采用关键字实参传值
   print(addThreeNums(a=1, b=2, c=3))		# 指名道姓地传入a，b，c
   print(addThreeNums(c=1, b=2, a=3))		# 可以打乱顺序
    # 采用关键字和位置实参混合传值
   print(addThreeNums(1, 2, c=3))			# 位置实参放在最前面，1对应a，2对应b，然后指名道姓地为c传值
   '''
   错误示范：
   print(addThreeNums(2, b=1, 3))		# 位置实参没有全部放在最前面
   print(addThreeNums(b=1, a=3))			# 实参个数和形参不一致
   print(addThreeNums(1, 1, a=3))		# 前两个为位置实参，对应a、b，第三个关键字实参对a重复赋值，且参数c缺失
   '''
   ```

3. 默认形参

   即有默认值的形参，在定义函数阶段，就已经为该形参赋值了。

   注意：

   1. 在定义阶段就已经被赋值，意味着在调用阶段可以不用为其赋值；
   2. 位置形参应该放到默认形参**前面**；
   3. 默认参数的值在函数定义阶段就已固定，但你仍然可以为他赋新值。

   例如：

   ```python
   def strcat(mul, str="Str"):		# 默认实参str1、str2，定义时已经被赋值
       return (str + ', ') * (mul - 1) + str
   print(strcat(3))				# Str, Str, Str，可以不为str进行赋值，这样str为默认值"Str"
   print(strcat(3, "Hi"))			# Hi, Hi, Hi，当传入默认参数时，将使用新值
   '''
   错误示范（函数定义）：
   def strcat(str="Str", mul):		# 错误，位置形参没有放到默认形参前面
       ...
   '''
   ```

4. 不定长参数（`*args`和`**kwargs`）

   在介绍这种参数类型时，我们先介绍**拆包**的概念：

   ### 拆包

   #### `* `标识符

   在我们学过的赋值语句中，可以依次给多个变量赋值，但是变量的数目和值的数目必须一致，例如：

   ```python
   a, b, c = 1, 2, 3
   d, e, f = [4, 5, 6]			# 也支持以列表的形式			
   ```

   但是，若值的个数多于变量的数目，即我们想让一个变量存储很多值（如元组的形式），可以在该变量前加上`*`，例如：

   ```python
   *a, b = [1, 2, 3]
   print(a, b)			# [1, 2] 3，变量b对应一个值，*a可对应多个值，系统会计算前把两个给a，最后一个给b
   
   a, *b, c, d = [1, 2, 3, 4, 5, 6, 7, 8]
   print(a, b, c, d)	# 1 [2, 3, 4, 5, 6] 7 8
   ```

   注意不能出现取值不唯一的情况，否则程序将无法判断，例如：

   ```python
   a, *b, *c = [1, 2, 3, 4, 5, 6]		# 报错，此时b与c的取值有很多不同的结果，程序无法判断结果
   ```

   `*`不仅可以用于变量的接收，也可以用于**打散**一个容器（列表/元组/集合），取出其中的内容，例如：

   ```python
   a = (1, 2, 3)
   print(*a)			# 1 2 3
   ```

   若在形参中含带`*`变量：会将调用函数时溢出的**位置实参**，保存成元组的形式，,赋值给`*`后的变量，再将其打散成一个个值，例如：

   ```python
   def func(a, b, *c):
       print(a, b, c)
       print(*c)
   func(1, 2, 3, 4, 5, 6, 7)			# 第一行打印 1 2 (3, 4, 5, 6, 7)，第二行打印 3 4 5 6 7
   ```

   此时`*c`即为一种不定长参数。

   #### `**` 标识符

   形参中也会出现含`**`的变量，意为将调用函数时溢出的**关键字实参**，保存成字典的形式，然后赋值`**`后的变量名,例如：

   ```python
   def func(a, **b):
       print(a, b)
   func(12, name='DrSHW', age=20)		# 12 {'name': 'DrSHW', 'age': 20}，后两个关键字实参变成了字典
   ```

   此时`**b`也为一种不定长参数。

   使用不定长参数要注意以下几点：

   1. 不定长参数一般放在默认形参之后；
   2. 一个函数中最多只能存在一个带`*`和`**`的参数，且带`*`的要放在带`**`的之后；
   3. 在形参中带`*`与`**`的，`*`后的变量名应该为`args`，`**`后跟的变量名应该时`kwargs`；

   若一个函数的参数为`(*args, **kwargs)`，这个函数将可以接收任何形式的参数，例如：

   ```python
   def func(*args, **kwargs):
       print(args, kwargs)
   func(1, 2, 3, a=1, b=['str', 123])		# (1, 2, 3) {'a': 1, 'b': ['str', 123]}
   ```

5. 命名关键字形参（很不常用）

   若一个函数存在带`*`和`**`的参数，那么这两个参数之间可以定义命名关键字形参。他们需要以关键字实参的方式进行传入，例如：

   ```python
   def func(*args, m, **kwargs):
       print(args, m, kwargs)
   func(1, 2, m=3, a=1)				# (1, 2) 3 {'a': 1}，命名关键字形参m会以关键字实参传入，而不是打包进kwargs
   ```

参数顺序归纳：

+ 形参： 位置形参 < 默认形参 < 不定长形参

+ 实参： 位置实参 < 关键字实参

最后一个例子：

```python
def foo(x, y=0, *args, m, n, **kwargs):					# 观察各类形参的位置
    print(x,y)
    print(args)
    print(m,n)
    print(kwargs)
foo(1, 2, 3, 4, 5, m=100, n=200, a=1, b=2, c=3)			# 观察传值过程
'''
1 2
(3, 4, 5)
100 200
{'a': 1, 'b': 2, 'c': 3}
'''
foo(1, m=100, n=200, a=1, b=2, c=3)
'''
1 0
()
100 200
{'a': 1, 'b': 2, 'c': 3}
'''
```

## 函数的返回值

我们已经对返回值有了一些概念。返回值通过`return`关键字进行标注，有以下注意点：

1. `return`是一个函数结束的标志，函数内可以有多个`return`，但只要执行一次，整个函数就会结束运行；若只写`return`而不加参数，则默认`return None；`
2. `return` 的返回值无类型限制，即可以是任意数据类型 ；
3. `return` 的返回值无个数限制，即可以用逗号分隔开多个任意类型的值 ；
+ 0个：返回`None`，ps：不写`return`默认会在函数的最后一行添加`return None`；
   + 1个：返回的值就是该值本身；
+ 多个：返回值是元组；

4. `return`是函数结束的标志，可以用来打断函数中的循环。

例如：

```python
def func1(a):			# 可以有多个return
    if a == 1:
        return			# 默认return None
    elif a == 2:
        return 15		# 一个参数，返回15本身
    else:
        return 1, 'DrSHW', (9, 8)	# 多个参数，会打包成元组一起返回
print(func1(1))         # None
print(func1(2))         # 15
print(func1(3))         # (1, 'DrSHW', (9, 8))

def func2(n):
    i = 0
    while True:
        i += 1
        if i > n:
            return 'break the loop'
print(func2(10))        # break the loop，return关键字可以跳出循环
```

函数的返回值本质上是值，也可以作为参数传给函数，例如：

```python
def maxn(a, b)					# 计算两数的最大值
	return a if a > b else return b
a = 1
b = 2
c = 3
maxNum = max(max(a, b), c)		# 将max(a, b)的返回值作为参数传入
print(maxNum)					# 3
```

## 一些常用的内置函数

在之前，我们已经接触过许多内置函数，如`print()`。

Python中还内置了许多常用的函数，如下：

1. `abs()`：传入一个数，求取其绝对值：

   ```python
   print(abs(-5))			# 5
   print(abs(5.1))			# 5.1
   ```

2. `all()/any()`：传入一个可迭代对象(如列表，会在**迭代器与生成器**一节中说明)，用于判断其中是否含有/均为空值。

   + `all(可迭代对象)`表示：可迭代对象中的值全为真才返回`True`，否则返回`False`。若可迭代对象为空，则为真`True`。

   + `any(可迭代对象)`表示：可迭代对象中的值全为假才返回`False`，否则返回`True`。若可迭代对象为空，则返回`False`。

   例如：

   ```python
   print(any([1,'',None]))		# False，存在''，None隐含的布尔值为False，有一个False就返回False
   print(any([0,'',None]))		# False，0，''，None隐含的布尔值全为False
   print(any([]))				# True，可迭代对象为空列表
   print(any(''))				# False，可迭代对象为空字符串
   ```

3. 聚合函数`max() / min()/ sum() `，传入一组数据，进行以下聚合运算：

   + `max()`：求取数据的最大值。

   + `min()`：求取数据的最小值。

   + `sum()`：求取数据的总和。

   例如：

   ```python
   a = [1,2,5,8,3]
   # 求最大值
   print(max(a))			# 8
   # 求最小值
   print(min(a))			# 1
   # 求和
   print(sum(a))			# 19
   ```

4. `ord()/chr()`

   在**字符编码**一节中，我们会介绍到：

   每一个英文字符，如`'a'`、`'%'`、`'\n'`、`' '`，都对应了一个`ascii`编码码数值。

   + `ord()`中传入一个字符，会将该字符转换成对应`ascii`编码。

   + `chr()`中传入一个数值，会将该数值转换成`ascii`编码表中对应的字符。

   例如：

   ```python
   print(ord('a'))			# 97
   print(chr(97))			# a
   print(ord('A'))			# 65
   print(chr(65))			# A

5. `zip()`拉链函数：

   传入两个列表或元组，取两参数中长度最小的那个，将其一一对应地结合成键值对的形式。超出长度的部分不会被使用。

   返回的是一个zip对象，一般将其转换为列表或字典使用，例如：

   ```python
   t1 = ['a', 'b', 'c', 'd', 'e']      # e 被抛弃
   t2 = [1, 2, 3, 4]
   # 通过索引
   print(zip(t1, t2))					# <zip object at 0x0000015BA4E1DD00>
   print(list(zip(t1, t2)))			# [('a', 1), ('b', 2), ('c', 3), ('d', 4)]，转换为列表
   print(dict(zip(t1, t2)))			# {'a': 1, 'b': 2, 'c': 3, 'd': 4}，转换为字典
   ```

6. `exec()`和`eval()`函数

   传入一段符合Python语法的字符串，它们都会执行字符串中包裹的Python代码，例如：

   ```python
   exec('print("Hello")')			# Hello
   eval('print("Hello")')			# Hello
   ```

   它们的不同点：

   + `exec()`函数只执行字符串中的代码，返回`None`；而`eval()`函数会返回表达式的结果，例如：

     ```python
     res1 = exec('1 + 1')
     res2 = eval('1 + 1')
     print(res1, res2)           # None 2，eval()返回了表达式的值
     ```

   + `exec()`函数可执行多行字符串中的代码；而`eval()`函数不支持，例如：

     ```python
     exec(
     '''
     a = 2 ** 3
     print(a)
     '''
     )	# 8，可执行
     
     eval(
     '''
     a = 2 ** 3
     print(a)
     '''
     )	# 报错，不支持多行字符串
     ```

7. `sorted()`函数，传入一个可迭代对象，可对对象内容进行排序。

   参数`reverse`默认为`False`，即升序排序；`reverse`取`True`表示降序排序，例如：

   ```python
   nums = [11, 33, 22, 9, 1]
   res = sorted(nums)
   print(res)				# [1, 9, 11, 22, 33]
   rev_res = sorted(nums, reverse=True)
   print(rev_res)			# [33, 22, 11, 9, 1]
   ```

   
